<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PBM Breaks - Live PokÃ©mon Breaks</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        :root {
            --suicune-blue: #4169E1; --crystal-aqua: #00BFFF; --dark-bg: #0D1117; --card: #161B22;
            --text: #E6EDF3; --muted: #8B949E; --glow: rgba(65,105,225,0.5); --red: #FF6B6B; --orange: #F08030;
        }
        body {font-family:'Montserrat',sans-serif;margin:0;background:var(--dark-bg);color:var(--text);min-height:100vh;
            background-image:url('https://assets.pokemon.com/assets/cms2/img/pokedex/full/245.png'),
            radial-gradient(circle at top left,rgba(0,191,255,0.1),transparent 50%),
            radial-gradient(circle at bottom right,rgba(65,105,225,0.1),transparent 50%);
            background-repeat:no-repeat;background-position:right -10% bottom -15%,top left,bottom right;
            background-size:50%,80%,80%;background-attachment:fixed;overflow-x:hidden;}
        body::before{content:'';position:absolute;inset:0;background:linear-gradient(rgba(13,17,23,0.92),rgba(13,17,23,0.92));z-index:-1;}
        header{background:var(--card);padding:20px;text-align:center;border-bottom:3px solid var(--suicune-blue);box-shadow:0 4px 20px rgba(0,0,0,0.5);}
        .header-logo{max-width:160px;filter:drop-shadow(0 0 20px var(--glow));transition:0.4s;}
        .header-logo:hover{transform:scale(1.1) rotate(-5deg);}
        h1{font-family:'Press Start 2P',cursive;font-size:2.4rem;margin:10px 0;color:var(--crystal-aqua);
            text-shadow:4px 4px var(--suicune-blue),7px 7px #000;}
        .hero{max-width:1300px;margin:40px auto;padding:50px 30px;background:linear-gradient(135deg,rgba(22,27,34,0.95),rgba(13,17,23,0.98));
            border:2px solid var(--crystal-aqua);border-radius:20px;text-align:center;box-shadow:0 0 40px rgba(0,191,255,0.4);position:relative;overflow:hidden;}
        .hero::before{content:'';position:absolute;inset:-50%;background:radial-gradient(circle,rgba(0,191,255,0.15),transparent 70%);animation:pulse 8s infinite;}
        @keyframes pulse{0%,100%{transform:translate(20%,20%)}50%{transform:translate(-20%,-20%)}}
        .hero-title{font-family:'Press Start 2P',cursive;font-size:2.8rem;background:linear-gradient(90deg,#FF6B6B,#F08030,#00BFFF);
            -webkit-background-clip:text;-webkit-text-fill-color:transparent;margin:0 0 20px;}
        .packs{display:flex;justify-content:center;flex-wrap:wrap;gap:20px;margin:30px 0;}
        .packs img{height:180px;border-radius:12px;box-shadow:0 0 20px rgba(0,191,255,0.4);transition:0.3s;}
        .packs img:hover{transform:scale(1.1) rotate(3deg);}
        .price{font-family:'Press Start 2P',cursive;font-size:3.8rem;color:#FF6B6B;text-shadow:3px 3px #000;margin:20px 0;}
        .countdown{font-size:2.2rem;font-weight:700;color:var(--crystal-aqua);margin:20px 0;}
        .btn{display:inline-block;background:linear-gradient(135deg,var(--red),var(--orange));color:white;padding:18px 50px;
            border-radius:12px;font-size:1.4rem;font-weight:600;text-decoration:none;margin-top:20px;box-shadow:0 8px 25px rgba(255,107,107,0.6);transition:0.4s;}
        .btn:hover{transform:translateY(-4px);box-shadow:0 12px 35px rgba(255,107,107,0.8);}
        main{max-width:1300px;margin:0 auto;padding:20px;}
        .section-title{font-family:'Press Start 2P',cursive;text-align:center;font-size:1.8rem;margin:60px 0 40px;color:var(--crystal-aqua);}
        .store-container{display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:30px;margin-bottom:80px;}
        .item-card{background:var(--card);border:1px solid var(--suicune-blue);border-radius:15px;padding:25px;box-shadow:0 6px 20px rgba(0,0,0,0.3);transition:0.4s;}
        .item-card:hover{transform:translateY(-10px) scale(1.03);box-shadow:0 15px 40px rgba(0,191,255,0.4);}
        .item-image{width:100%;height:220px;object-fit:contain;border-radius:10px;margin-bottom:20px;background:rgba(0,0,0,0.1);}
        .youtube{max-width:100%;aspect-ratio:16/9;border-radius:15px;overflow:hidden;box-shadow:0 0 30px rgba(0,191,255,0.3);margin:40px 0;}
        .chase-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:25px;max-width:1000px;margin:0 auto 80px;}
        .chase-card{text-align:center;background:rgba(22,27,34,0.8);padding:15px;border-radius:12px;border:1px solid var(--crystal-aqua);}
        footer{text-align:center;padding:40px;background:var(--card);color:var(--muted);}
        @media(max-width:768px){.hero-title{font-size:2rem;}.price{font-size:2.8rem;}.packs img{height:120px;}}
    </style>
</head>
<body>
    <header>
        <img src="https://assets.pokemon.com/assets/cms2/img/pokedex/full/245.png" alt="Suicune" class="header-logo">
        <h1>PBM BREAKS</h1>
    </header>

    <div class="hero" id="hero-section" style="display:none;">
        <h2 class="hero-title" id="weekly-title"></h2>
        <p style="font-size:1.6rem;color:#00BFFF;" id="weekly-subtitle"></p>
        <div class="packs" id="pack-images"></div>
        <p class="price" id="weekly-price"></p>
        <div class="countdown" id="countdown">Loading next break...</div>
        <a href="#" target="_blank" class="btn" id="weekly-form" style="display:none;">CLAIM SPOT NOW â€“ $50 SHIPPED</a>
    </div>

    <main>
        <h2 class="section-title">Live Stream</h2>
        <div class="youtube"><iframe src="https://www.youtube.com/embed/CHANGE_THIS_TO_YOUR_LIVE_ID" allowfullscreen></iframe></div>

        <h2 class="section-title">Available Breaks</h2>
        <div id="store-content" class="store-container"></div>

        <h2 class="section-title">This Week's Chase Cards</h2>
        <div class="chase-grid" id="chase-cards"></div>
    </main>

    <footer>Â© 2025 PBM Breaks â€¢ Live Every Thursday 8PM EST â€¢ Not affiliated with Nintendo/The PokÃ©mon Company</footer>

    <script>
        const API_URL = 'https://pokeballer-worker.kronborgnielsen.workers.dev/api';
        async function loadEverything() {
            try {
                const res = await fetch(`${API_URL}/items`);
                const items = await res.json();
                const weekly = items.find(i => i.name.toLowerCase() === "this weekâ€™s break");
                if (weekly) {
                    document.getElementById('hero-section').style.display = 'block';
                    document.getElementById('weekly-title').textContent = weekly.name;
                    document.getElementById('weekly-subtitle').textContent = "Scarlet & Violet + Mega Evolution Era MEGA MIX!";
                    document.getElementById('weekly-price').textContent = `$${weekly.price} SHIPPED`;
                    document.getElementById('weekly-form').href = weekly.googleFormLink;
                    document.getElementById('weekly-form').style.display = 'inline-block';
                    // You can add up to 6 pack URLs in description separated by comma
                    const packUrls = weekly.description.split(',').map(u=>u.trim()).filter(Boolean);
                    const packDiv = document.getElementById('pack-images');
                    packDiv.innerHTML = packUrls.map(url=>`<img src="${url}" alt="pack">`).join('');
                    // Countdown logic â€“ put date in stock field as "2025-11-20 20:00"
                    const countdown = document.getElementById('countdown');
                    const target = new Date(weekly.stock + ":00-05:00").getTime(); // assumes EST
                    const timer = setInterval(()=>{
                        const now = new Date().getTime();
                        const diff = target - now;
                        if (diff <= 0) { countdown.textContent = "ðŸ”´ LIVE RIGHT NOW!"; clearInterval(timer); return; }
                        const d = Math.floor(diff/(1000*60*60*24));
                        const h = Math.floor((diff%(1000*60*60*24))/(1000*60*60));
                        const m = Math.floor((diff%(1000*60*60))/(1000*60));
                        const s = Math.floor((diff%(1000*60))/1000);
                        countdown.textContent = `${d}d ${h}h ${m}m ${s}s`;
                    },1000);
                }
                // Render normal items (exclude the weekly one)
                const normalItems = items.filter(i => i.name.toLowerCase() !== "this weekâ€™s break");
                const container = document.getElementById('store-content');
                container.innerHTML = normalItems.map(item => `
                    <div class="item-card">
                        <img src="${item.image || 'https://assets.pokemon.com/assets/cms2/img/misc/trading-card-games/cards/tcg_default_card.png'}" class="item-image">
                        <h3>${item.name}</h3>
                        <p style="color:var(--muted);">${item.description}</p>
                        <div style="display:flex;justify-content:space-between;align-items:center;margin-top:auto;padding-top:20px;border-top:1px solid rgba(65,105,225,0.3);">
                            <span style="font-size:1.6rem;font-weight:700;color:var(--crystal-aqua);">$${item.price}</span>
                            <span style="background:rgba(0,191,255,0.2);padding:8px 15px;border-radius:8px;border:1px solid var(--crystal-aqua);">${item.stock} left</span>
                        </div>
                        ${item.stock > 0 ? `<a href="${item.googleFormLink}" target="_blank" class="btn" style="margin-top:20px;font-size:1.1rem;padding:14px;">Join Break!</a>` 
                        : `<div style="margin-top:20px;padding:15px;background:rgba(52,73,94,0.5);border-radius:10px;color:var(--muted);">Break Full!</div>`}
                    </div>`).join('');
                // Simple chase cards from weekly description if you put URLs after a |
                if (weekly && weekly.description.includes('|')) {
                    const chaseUrls = weekly.description.split('|')[1].split(',').map(u=>u.trim());
                    document.getElementById('chase-cards').innerHTML = chaseUrls.map(url=>`
                        <div class="chase-card"><img src="${url}" style="border-radius:8px;"><p>Hot Chase!</p></div>`).join('');
                }
            } catch(e) { console.error(e); }
        }
        loadEverything();
    </script>
</body>
</html>
