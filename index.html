<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PBM Breaks - PokÃ©mon League Store</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #0a0a15;
            --surface: #12121f;
            --card: #1a1a2e;
            --accent: #00eeff;
            --electric: #00ff9d;
            --purple: #9d4edd;
            --text: #ffffff;
            --text2: #e0e0ff;
        }

        * { margin:0; padding:0; box-sizing:border-box; }

        html, body {
            height: 100%;
            font-family: 'Inter', sans-serif;
            background: var(--bg);
            color: var(--text);
            overflow-x: hidden;
        }

        body {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            background-image: 
                radial-gradient(circle at 15% 20%, rgba(0,238,255,0.12) 0%, transparent 50%),
                radial-gradient(circle at 85% 80%, rgba(157,78,221,0.1) 0%, transparent 50%),
                radial-gradient(circle at 50% 50%, rgba(0,255,157,0.06) 0%, transparent 70%);
        }

        /* Super-light floating orbs (no heavy blur) */
        .orb {
            position: absolute;
            border-radius: 50%;
            background: radial-gradient(circle, var(--accent), transparent);
            opacity: 0.18;
            pointer-events: none;
            filter: blur(30px);
        }
        .orb:nth-child(1){width:650px;height:650px;top:-12%;left:-8%;}
        .orb:nth-child(2){width:850px;height:850px;bottom:-22%;right:-18%;}
        .orb:nth-child(3){width:550px;height:550px;top:20%;right:8%;}

        /* Lightweight floating PokÃ©mon */
        .float-poke {
            position: absolute;
            opacity: 0.07;
            pointer-events: none;
            animation: drift linear infinite;
            width: 180px;
            filter: brightness(2.5);
        }
        @keyframes drift {
            0% { transform: translateY(110vh) rotate(0deg); }
            100% { transform: translateY(-150px) rotate(360deg); }
        }

        header {
            text-align: center;
            padding: 4rem 1rem 5rem;
            position: relative;
            overflow: hidden;
        }
        .header-logo {
            width: 190px;
            filter: drop-shadow(0 0 50px var(--accent));
            animation: levitate 7s infinite ease-in-out;
        }
        @keyframes levitate { 0%,100% { transform: translateY(0); } 50% { transform: translateY(-22px); } }

        h1 {
            font-size: 6.2rem;
            font-weight: 900;
            letter-spacing: -4px;
            background: linear-gradient(90deg, #00eeff, #ffffff, #ff00ff);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 90px rgba(0,238,255,0.7);
            margin-top: 1.5rem;
        }

        main {
            flex: 1;
            max-width: 1600px;
            margin: 0 auto;
            padding: 0 1.5rem 5rem;
            position: relative;
            z-index: 2;
        }

        .store-intro {
            text-align: center;
            padding: 5rem 2.5rem;
            margin-bottom: 5rem;
            background: linear-gradient(135deg, rgba(26,26,46,0.92), rgba(18,18,31,0.98));
            border-radius: 42px;
            border: 2px solid rgba(0,238,255,0.45);
            box-shadow: 0 30px 100px rgba(0,0,0,0.7);
            backdrop-filter: blur(16px);
        }
        .store-intro h2 {
            font-size: 4.5rem;
            font-weight: 900;
            background: linear-gradient(120deg, var(--electric), var(--accent), var(--purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 1rem;
        }
        .store-intro p { font-size: 1.45rem; color: var(--text2); max-width: 900px; margin: 0 auto; line-height: 1.9; }

        /* YOUTUBE SECTION - EPIC BUT LIGHT */
        .youtube-section { margin: 7rem 0; }
        .youtube-title {
            font-size: 5.2rem;
            font-weight: 900;
            text-align: center;
            margin-bottom: 4rem;
            background: linear-gradient(90deg, #ff0080, #00eeff, #00ff9d, #ff00ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 70px rgba(0,238,255,0.8);
        }
        .youtube-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(380px, 1fr));
            gap: 3rem;
            padding: 2rem;
            background: rgba(18,18,31,0.6);
            border-radius: 42px;
            border: 1.5px solid rgba(0,238,255,0.3);
            box-shadow: 0 25px 80px rgba(0,0,0,0.6);
        }
        .yt-video {
            position: relative;
            border-radius: 32px;
            overflow: hidden;
            background: var(--card);
            border: 2px solid transparent;
            transition: all 0.45s ease;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
            cursor: pointer;
        }
        .yt-video:hover {
            transform: translateY(-25px) scale(1.05);
            border-color: var(--accent);
            box-shadow: 0 40px 100px rgba(0,238,255,0.45);
        }
        .yt-thumb { width: 100%; height: 240px; object-fit: cover; display: block; }
        .play-button {
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            width: 80px; height: 80px;
            background: rgba(0,0,0,0.75);
            border: 5px solid white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 38px;
            color: white;
            transition: all 0.3s;
        }
        .yt-video:hover .play-button { transform: translate(-50%, -50%) scale(1.25); background: var(--accent); }
        .yt-overlay { position: absolute; bottom: 0; left: 0; right: 0; padding: 2rem 1.5rem 1.5rem; background: linear-gradient(to top, rgba(10,10,21,0.95), transparent); }
        .yt-title { font-size: 1.3rem; font-weight: 800; color: var(--text); line-height: 1.45; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
        .upcoming-badge {
            position: absolute; top: 20px; left: 20px;
            background: linear-gradient(135deg, #ff006e, #ff8c00);
            color: white; padding: 0.6rem 1.4rem;
            border-radius: 50px; font-weight: 900; font-size: 0.95rem;
            box-shadow: 0 0 40px rgba(255,0,110,0.8);
            animation: badgePulse 2s infinite;
        }
        .live-now { background: linear-gradient(90deg, #ff0000, #ff0066) !important; animation: livePulse 1.5s infinite !important; }
        @keyframes badgePulse { 0%,100% { transform: scale(1); } 50% { transform: scale(1.1); } }
        @keyframes livePulse { 0%,100% { box-shadow: 0 0 30px #ff0000; } 50% { box-shadow: 0 0 70px #ff0000; } }

        /* Store & footer */
        .store-container { display: grid; grid-template-columns: repeat(auto-fill, minmax(370px, 1fr)); gap: 3rem; margin-top: 5rem; }
        .item-card { background: var(--card); border-radius: 34px; overflow: hidden; border: 1.5px solid rgba(0,238,255,0.25); transition: all 0.45s ease; box-shadow: 0 22px 55px rgba(0,0,0,0.5); display: flex; flex-direction: column; }
        .item-card:hover { transform: translateY(-22px) scale(1.04); border-color: var(--accent); box-shadow: 0 45px 110px rgba(0,238,255,0.4); }
        .item-image { width: 100%; height: 300px; object-fit: cover; transition: transform 0.6s ease; }
        .item-card:hover .item-image { transform: scale(1.14); }
        .card-content { padding: 2.3rem; background: linear-gradient(to top, var(--surface), transparent); flex-grow: 1; display: flex; flex-direction: column; }
        .item-card h3 { font-size: 2.1rem; font-weight: 800; background: linear-gradient(90deg, var(--accent), #fff); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 1rem; }
        .description { color: var(--text2); margin-bottom: 1.6rem; line-height: 1.8; flex-grow: 1; }
        .item-details { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.8rem; padding-top: 1rem; border-top: 1px solid rgba(0,238,255,0.25); }
        .item-price { font-size: 2.7rem; font-weight: 900; color: var(--electric); text-shadow: 0 0 35px rgba(0,255,157,0.6); }
        .item-stock { background: rgba(0,238,255,0.22); color: var(--accent); padding: 0.7rem 1.3rem; border-radius: 50px; font-weight: 700; border: 1.5px solid var(--accent); }
        .action-button, .out-of-stock { width: 100%; padding: 1.5rem; text-align: center; border-radius: 26px; font-size: 1.45rem; font-weight: 800; margin-top: auto; }
        .action-button { background: linear-gradient(135deg, var(--accent), var(--purple)); color: white; text-decoration: none; box-shadow: 0 15px 45px rgba(0,238,255,0.5); transition: all 0.35s; }
        .action-button:hover { transform: translateY(-7px); box-shadow: 0 28px 70px rgba(0,238,255,0.7); background: linear-gradient(135deg, #00ffff, #d946ef); }
        .out-of-stock { background: rgba(255,77,77,0.28); color: #ff6b6b; border: 2.5px solid #ff4444; }

        footer {
            margin-top: auto;
            padding: 2.2rem 1rem;
            text-align: center;
            color: #777;
            background: rgba(10,10,21,0.99);
            border-top: 1px solid rgba(0,238,255,0.2);
            font-size: 0.95rem;
        }
        footer p:last-child { font-size: 0.8rem; color: #555; margin-top: 0.5rem; }

        #lightbox-overlay { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.97); backdrop-filter: blur(25px); justify-content: center; align-items: center; z-index: 1000; cursor: zoom-out; }
        #lightbox-overlay.show { display: flex; }
        #lightbox-image { max-width: 96vw; max-height: 96vh; border-radius: 34px; border: 6px solid var(--accent); box-shadow: 0 0 130px rgba(0,238,255,0.8); }

        @media (max-width: 768px) {
            h1, .youtube-title { font-size: 4rem; }
            .store-intro h2 { font-size: 3.5rem; }
            .youtube-grid, .store-container { grid-template-columns: 1fr; gap: 2.2rem; padding: 1.2rem; }
            .yt-thumb { height: 210px; }
        }
    </style>
</head>
<body>

    <div class="orb"></div><div class="orb"></div><div class="orb"></div>

    <!-- Lightweight floating PokÃ©mon -->
    <img src="https://assets.pokemon.com/assets/cms2/img/pokedex/full/006_f2.png" class="float-poke" style="left:4%;animation-duration:45s;" loading="lazy">
    <img src="https://assets.pokemon.com/assets/cms2/img/pokedex/full/150_f2.png" class="float-poke" style="right:10%;animation-duration:55s;animation-delay:15s;" loading="lazy">
    <img src="https://assets.pokemon.com/assets/cms2/img/pokedex/full/382_f2.png" class="float-poke" style="left:12%;animation-duration:48s;animation-delay:25s;" loading="lazy">

    <header>
        <img src="https://assets.pokemon.com/assets/cms2/img/pokedex/full/245.png" alt="Suicune" class="header-logo" loading="lazy">
        <h1>PBM BREAKS</h1>
    </header>

    <main>
        <div class="store-intro">
            <h2>Welcome to PBM Breaks!</h2>
            <p>Get ready for live TCG pack openings and curated breaks with Pokeballer Mike! We're live on YouTube, offering exclusive bundles and the thrill of the hunt. Grab your spot and let's pull some rare cards!</p>
        </div>

        <section class="youtube-section">
            <h2 class="youtube-title">LIVE BREAKS ON YOUTUBE</h2>
            <div class="youtube-grid" id="youtube-videos"></div>
        </section>

        <div id="store-content" class="store-container"></div>
    </main>

    <footer>
        <p>Â© 2025 PBM Breaks. All Rights Reserved.</p>
        <p>Not affiliated with Nintendo or The PokÃ©mon Company</p>
    </footer>

    <div id="lightbox-overlay"><img id="lightbox-image" src="" alt=""></div>

    <script>
        const API_URL = 'https://pokeballer-worker.kronborgnielsen.workers.dev/api';
        const CHANNEL_ID = "UCdFYy9uChCNAWbvVhTYwHaQ";

        async function loadItems() {
            const container = document.getElementById('store-content');
            container.innerHTML = '<div style="grid-column:1/-1;text-align:center;padding:5rem;color:var(--accent);font-size:2.3rem;">Loading Breaks...</div>';
            try {
                const res = await fetch(`${API_URL}/items`);
                const items = await res.json();
                container.innerHTML = '';
                if (!items.length) { container.innerHTML = '<p style="grid-column:1/-1;text-align:center;color:#aaa;font-size:1.8rem;">No active breaks â€” next one dropping soon!</p>'; return; }
                items.forEach((item, i) => {
                    const card = document.createElement('div');
                    card.className = 'item-card';
                    const img = item.image || 'https://assets.pokemon.com/assets/cms2/img/misc/trading-card-games/cards/tcg_default_card.png';
                    const btn = item.stock > 0 && item.googleFormLink ? `<a href="${item.googleFormLink}" target="_blank" class="action-button">JOIN BREAK!</a>` : `<div class="out-of-stock">SOLD OUT</div>`;
                    card.innerHTML = `<img src="${img}" alt="${item.name}" class="item-image" loading="lazy"><div class="card-content"><h3>${item.name}</h3><p class="description">${item.description}</p><div class="item-details"><span class="item-price">$${item.price.toFixed(2)}</span><span class="item-stock">Spots: ${item.stock}</span></div>${btn}</div>`;
                    container.appendChild(card);
                });
            } catch { container.innerHTML = '<p style="grid-column:1/-1;color:#ff4444;text-align:center;">Failed to load â€” refresh!</p>'; }
        }

        async function loadYouTubeVideos() {
            const container = document.getElementById('youtube-videos');
            container.innerHTML = '<div style="grid-column:1/-1;padding:5rem;color:var(--accent);font-size:1.9rem;">Loading latest videos...</div>';

            const proxies = ['https://api.allorigins.ml/raw?url=', 'https://corsproxy.io/?', 'https://thingproxy.freeboard.io/fetch/'];
            let success = false;

            for (let proxy of proxies) {
                try {
                    const url = `${proxy}${encodeURIComponent('https://www.youtube.com/feeds/videos.xml?channel_id=' + CHANNEL_ID)}`;
                    const xmlText = await (await fetch(url)).text();
                    const xml = new DOMParser().parseFromString(xmlText, "application/xml");
                    if (xml.querySelector("parsererror")) continue;

                    const entries = Array.from(xml.querySelectorAll("entry")).slice(0, 6);
                    container.innerHTML = '';
                    let count = 0;

                    for (let entry of entries) {
                        if (count >= 3) break;
                        const videoId = entry.querySelector("yt\\:videoId, videoId")?.textContent;
                        if (!videoId) continue;
                        const title = entry.querySelector("title")?.textContent || "Untitled";
                        const isLive = title.toLowerCase().includes("live") || title.includes("ðŸ”´");
                        const isUpcoming = title.toLowerCase().includes("premiere") || title.toLowerCase().includes("scheduled");

                        const thumb = `https://i.ytimg.com/vi/${videoId}/maxresdefault.jpg`;

                        const card = document.createElement('div');
                        card.className = 'yt-video';
                        card.onclick = () => window.open(`https://www.youtube.com/watch?v=${videoId}`, '_blank');
                        card.innerHTML = `
                            <img src="${thumb}" alt="${title}" class="yt-thumb" loading="lazy">
                            <div class="play-button">â–¶</div>
                            ${(isLive || isUpcoming) ? `<div class="upcoming-badge ${isLive?'live-now':''}">${isLive?'LIVE NOW':'UPCOMING'}</div>` : ''}
                            <div class="yt-overlay"><div class="yt-title">${title}</div></div>
                        `;
                        container.appendChild(card);
                        count++;
                    }
                    if (count > 0) { success = true; break; }
                } catch (e) {}
            }

            if (!success) {
                container.innerHTML = `<div style="grid-column:1/-1;padding:4rem;text-align:center;"><a href="https://www.youtube.com/@pokeballermike" target="_blank" style="color:var(--accent);font-size:1.7rem;font-weight:800;text-decoration:underline;">Watch @pokeballermike â†’</a></div>`;
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            loadItems();
            loadYouTubeVideos();

            const overlay = document.getElementById('lightbox-overlay');
            const img = document.getElementById('lightbox-image');
            document.getElementById('store-content').addEventListener('click', e => {
                if (e.target.classList.contains('item-image')) { img.src = e.target.src; overlay.classList.add('show'); }
            });
            overlay.addEventListener('click', () => { overlay.classList.remove('show'); setTimeout(() => img.src = '', 300); });
        });
    </script>
</body>
</html>
