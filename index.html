<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PBM Breaks - PokÃ©mon League Store</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #0a0a15;
            --surface: #12121f;
            --card: #1a1a2e;
            --accent: #00eeff;
            --electric: #00ff9d;
            --purple: #9d4edd;
            --text: #ffffff;
            --text2: #e0e0ff;
        }

        * { margin:0; padding:0; box-sizing:border-box; }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg);
            color: var(--text);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(0,238,255,0.15) 0%, transparent 50%),
                radial-gradient(circle at 90% 80%, rgba(157,78,221,0.15) 0%, transparent 50%),
                radial-gradient(circle at 50% 50%, rgba(0,255,157,0.08) 0%, transparent 70%);
        }

        .orb {
            position: absolute;
            border-radius: 50%;
            background: radial-gradient(circle, var(--accent), transparent);
            filter: blur(40px);
            opacity: 0.4;
            animation: float 20s infinite linear;
        }
        .orb:nth-child(1){width:600px;height:600px;top:-10%;left:-10%;animation-duration:25s;background:radial-gradient(circle,rgba(0,238,255,0.4),transparent);}
        .orb:nth-child(2){width:800px;height:800px;bottom:-20%;right:-15%;animation-duration:30s;background:radial-gradient(circle,rgba(157,78,221,0.3),transparent);}
        .orb:nth-child(3){width:500px;height:500px;top:30%;right:10%;animation-duration:22s;background:radial-gradient(circle,rgba(0,255,157,0.35),transparent);}

        @keyframes float {
            0%,100%{transform:translate(0,0) rotate(0deg);}
            50%{transform:translate(100px,-100px) rotate(180deg);}
        }

        .float-poke {
            position: absolute;
            opacity: 0.07;
            pointer-events: none;
            animation: drift linear infinite;
            filter: brightness(2);
        }
        @keyframes drift {
            0% { transform: translateY(100vh) rotate(0deg); }
            100% { transform: translateY(-100px) rotate(360deg); }
        }

        header {
            position: relative;
            text-align: center;
            padding: 4rem 1rem 6rem;
            overflow: hidden;
        }

        .header-glow {
            position: absolute;
            inset: 0;
            background: conic-gradient(from 90deg at 50% 20%, #00eeff, #9d4edd, #00ff9d, #00eeff);
            filter: blur(80px);
            opacity: 0.6;
            animation: rotate 20s infinite linear;
        }
        @keyframes rotate { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        .header-logo {
            width: 180px;
            filter: drop-shadow(0 0 40px var(--accent));
            animation: levitate 6s infinite ease-in-out;
        }
        @keyframes levitate {
            0%,100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }

        h1 {
            font-size: 5.5rem;
            font-weight: 900;
            letter-spacing: -3px;
            background: linear-gradient(90deg, #00eeff, #ffffff, #9d4edd);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 60px rgba(0,238,255,0.6);
            margin-top: 1rem;
        }

        main { max-width: 1400px; margin: 0 auto; padding: 0 1rem 6rem; position: relative; z-index: 2; }

        .store-intro {
            text-align: center;
            padding: 4rem 2rem;
            margin-bottom: 5rem;
            background: linear-gradient(135deg, rgba(26,26,46,0.8), rgba(18,18,31,0.9));
            border-radius: 32px;
            border: 1px solid rgba(0,238,255,0.3);
            box-shadow: 0 20px 80px rgba(0,0,0,0.6), 0 0 100px rgba(0,238,255,0.2);
            backdrop-filter: blur(16px);
        }

        .store-intro h2 {
            font-size: 3.8rem;
            font-weight: 900;
            background: linear-gradient(120deg, var(--electric), var(--accent), var(--purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 1rem;
        }

        .store-intro p {
            font-size: 1.35rem;
            color: var(--text2);
            max-width: 800px;
            margin: 0 auto;
            line-height: 1.8;
        }

        /* === YOUTUBE SECTION === */
        .youtube-section {
            margin: 7rem auto;
            text-align: center;
        }

        .section-title {
            font-size: 4.2rem;
            font-weight: 900;
            background: linear-gradient(90deg, #0000ff, #ff00c8, #00ff9d);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 3rem;
            text-shadow: 0 0 50px rgba(0,238,255,0.6);
        }

        .youtube-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(340px, 1fr));
            gap: 2.5rem;
            max-width: 1400px;
            margin: 0 auto;
        }

        .yt-video {
            position: relative;
            border-radius: 28px;
            overflow: hidden;
            box-shadow: 0 20px 50px rgba(0,0,0,0.6);
            transition: all 0.4s ease;
            border: 2px solid transparent;
            background: var(--card);
        }

        .yt-video:hover {
            transform: translateY(-15px) scale(1.03);
            border-color: var(--accent);
            box-shadow: 0 35px 90px rgba(0,238,255,0.4);
        }

        .yt-video iframe {
            width: 100%;
            height: 220px;
            border: none;
        }

        .yt-video .title {
            padding: 1.2rem;
            font-size: 1.15rem;
            font-weight: 700;
            color: var(--text2);
            background: rgba(0,0,0,0.5);
            backdrop-filter: blur(10px);
        }

        .upcoming-badge {
            position: absolute;
            top: 16px; left: 16px;
            background: linear-gradient(135deg, #ff006e, #ff8c00);
            color: white;
            padding: 0.5rem 1.2rem;
            border-radius: 50px;
            font-weight: 900;
            font-size: 0.9rem;
            letter-spacing: 1px;
            box-shadow: 0 0 30px rgba(255,0,110,0.7);
            z-index: 10;
            animation: pulse 2s infinite;
        }

        .live-now {
            background: linear-gradient(90deg, #ff0000, #ff0066) !important;
            animation: livePulse 1.5s infinite !important;
        }

        @keyframes pulse { 0%,100% { transform: scale(1); } 50% { transform: scale(1.05); } }
        @keyframes livePulse { 0%,100% { box-shadow: 0 0 20px #ff0000; } 50% { box-shadow: 0 0 50px #ff0000; } }

        /* === STORE CARDS === */
        .store-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(360px, 1fr));
            gap: 2.5rem;
        }

        .item-card {
            background: var(--card);
            border-radius: 28px;
            overflow: hidden;
            position: relative;
            border: 1px solid rgba(0,238,255,0.2);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.2);
            box-shadow: 0 15px 40px rgba(0,0,0,0.4);
        }

        .item-card::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: linear-gradient(135deg, rgba(0,238,255,0.15), transparent 50%);
            opacity: 0;
            transition: opacity 0.4s;
        }

        .item-card:hover {
            transform: translateY(-20px) scale(1.04);
            box-shadow: 0 30px 80px rgba(0,0,0,0.6), 0 0 60px rgba(0,238,255,0.4);
            border-color: var(--accent);
        }

        .item-card:hover::before { opacity: 1; }

        .item-image {
            width: 100%;
            height: 280px;
            object-fit: cover;
            transition: transform 0.6s ease;
        }
        .item-card:hover .item-image { transform: scale(1.12); }

        .card-content { padding: 2rem; background: linear-gradient(to top, var(--surface), transparent); }
        .item-card h3 { font-size: 1.8rem; font-weight: 800; margin-bottom: 0.8rem; background: linear-gradient(90deg, var(--accent), #ffffff); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .description { color: var(--text2); margin-bottom: 1.5rem; line-height: 1.7; }
        .item-details { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; }
        .item-price { font-size: 2.4rem; font-weight: 900; color: var(--electric); text-shadow: 0 0 20px rgba(0,255,157,0.5); }
        .item-stock { background: rgba(0,238,255,0.2); color: var(--accent); padding: 0.6rem 1.2rem; border-radius: 50px; font-weight: 700; border: 1px solid var(--accent); }
        .action-button { width: 100%; padding: 1.2rem; background: linear-gradient(135deg, var(--accent), var(--purple)); color: white; border: none; border-radius: 20px; font-size: 1.3rem; font-weight: 800; cursor: pointer; transition: all 0.3s; box-shadow: 0 10px 30px rgba(0,238,255,0.4); }
        .action-button:hover { transform: translateY(-5px); box-shadow: 0 20px 50px rgba(0,238,255,0.6); background: linear-gradient(135deg, #00ffff, #b14eff); }
        .out-of-stock { background: rgba(255,77,77,0.25); color: #ff6b6b; padding: 1.2rem; border-radius: 20px; text-align: center; font-weight: 800; border: 1px solid #ff4444; }

        footer {
            padding: 2rem 1rem;
            text-align: center;
            font-size: 0.9rem;
            color: #666;
            border-top: 1px solid rgba(0,238,255,0.15);
            background: linear-gradient(to top, rgba(10,10,21,0.98), transparent);
            backdrop-filter: blur(10px);
            margin-top: auto;
        }

        footer p { margin: 0.5rem 0; }
        footer p:last-child { font-size: 0.8rem; color: #555; }

        #lightbox-overlay {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.96);
            backdrop-filter: blur(20px);
            justify-content: center;
            align-items: center;
            z-index: 1000;
            cursor: zoom-out;
        }
        #lightbox-overlay.show { display: flex; }
        #lightbox-image { max-width: 94vw; max-height: 94vh; border-radius: 24px; border: 4px solid var(--accent); box-shadow: 0 0 100px rgba(0,238,255,0.6); }

        @media (max-width: 768px) {
            h1 { font-size: 3.8rem; }
            .store-intro h2, .section-title { font-size: 2.8rem; }
            .store-container, .youtube-grid { grid-template-columns: 1fr; }
            .item-card, .yt-video { max-width: 400px; margin: 0 auto; }
        }
    </style>
</head>
<body>

    <div class="orb"></div>
    <div class="orb"></div>
    <div class="orb"></div>

    <img src="https://assets.pokemon.com/assets/cms2/img/pokedex/full/006_f2.png" class="float-poke" style="width:180px; left:5%; animation-duration:40s;">
    <img src="https://assets.pokemon.com/assets/cms2/img/pokedex/full/150_f2.png" class="float-poke" style="width:220px; right:10%; animation-duration:50s; animation-delay:10s;">
    <img src="https://assets.pokemon.com/assets/cms2/img/pokedex/full/382_f2.png" class="float-poke" style="width:160px; left:15%; animation-duration:45s; animation-delay:20s;">

    <header>
        <div class="header-glow"></div>
        <img src="https://assets.pokemon.com/assets/cms2/img/pokedex/full/245.png" alt="Suicune" class="header-logo">
        <h1>PBM BREAKS</h1>
    </header>

    <main>
        <div class="store-intro">
            <h2>Welcome to PBM Breaks!</h2>
            <p>Get ready for live TCG pack openings and curated breaks with Pokeballer Mike! We're live on YouTube, offering exclusive bundles and the thrill of the hunt. Grab your spot and let's pull some rare cards!</p>
        </div>

        <!-- YOUTUBE SECTION -->
        <section class="youtube-section">
            <h2 class="section-title">LIVE ON YOUTUBE ðŸ”¥</h2>
            <div class="youtube-grid" id="youtube-videos">
                <!-- Videos load automatically -->
            </div>
        </section>

        <div id="store-content" class="store-container">
            <!-- Store items load here -->
        </div>
    </main>

    <footer>
        <p>Â© 2025 PBM Breaks. All Rights Reserved.</p>
        <p>Not affiliated with Nintendo or The PokÃ©mon Company</p>
    </footer>

    <div id="lightbox-overlay">
        <img id="lightbox-image" src="" alt="">
    </div>

    <script>
        const API_URL = 'https://pokeballer-worker.kronborgnielsen.workers.dev/api';

        // ===== LOAD STORE ITEMS =====
        async function loadItems() {
            const container = document.getElementById('store-content');
            container.innerHTML = '<div style="grid-column:1/-1;text-align:center;padding:4rem;font-size:2rem;color:var(--accent);">Loading Breaks...</div>';

            try {
                const res = await fetch(`${API_URL}/items`);
                const items = await res.json();
                container.innerHTML = '';
                if (items.length === 0) {
                    container.innerHTML = '<p style="grid-column:1/-1;text-align:center;color:#aaa;font-size:1.5rem;">No breaks right now â€” check back soon!</p>';
                    return;
                }
                items.forEach((item, i) => {
                    const card = document.createElement('div');
                    card.className = 'item-card';
                    card.style.animationDelay = `${i * 0.1}s`;
                    const img = item.image || 'https://assets.pokemon.com/assets/cms2/img/misc/trading-card-games/cards/tcg_default_card.png';
                    const btn = item.stock > 0 && item.googleFormLink 
                        ? `<a href="${item.googleFormLink}" target="_blank" class="action-button">JOIN BREAK!</a>`
                        : `<div class="out-of-stock">SOLD OUT</div>`;
                    card.innerHTML = `
                        <img src="${img}" alt="${item.name}" class="item-image">
                        <div class="card-content">
                            <h3>${item.name}</h3>
                            <p class="description">${item.description}</p>
                            <div class="item-details">
                                <span class="item-price">$${item.price.toFixed(2)}</span>
                                <span class="item-stock">Spots: ${item.stock}</span>
                            </div>
                            ${btn}
                        </div>
                    `;
                    container.appendChild(card);
                });
            } catch (e) {
                container.innerHTML = '<p style="grid-column:1/-1;color:#ff4444;text-align:center;">Failed to load â€” try refreshing!</p>';
            }
        }

        // ===== LOAD YOUTUBE VIDEOS (@PokeballerMike) =====
        async function loadYouTubeVideos() {
            const container = document.getElementById('youtube-videos');
            container.innerHTML = '<div style="grid-column:1/-1;padding:4rem;color:var(--accent);font-size:1.5rem;">Loading latest breaks from Pokeballer Mike...</div>';

            // Pokeballer Mike's real channel ID
            const CHANNEL_ID = "UCgD2vR0dEj9QRfJNU3d2zqQ";

            try {
                const rss = `https://api.rss2json.com/v1/api.json?rss_url=https://www.youtube.com/feeds/videos.xml?channel_id=${CHANNEL_ID}`;
                const res = await fetch(rss);
                const data = await res.json();
                const videos = data.items.slice(0, 8); // get more to catch upcoming ones

                container.innerHTML = '';
                let shown = 0;

                for (let video of videos) {
                    if (shown >= 4) break;

                    const videoId = video.guid.split('=')[1];
                    const isLive = video.title.includes("LIVE") || video.title.includes("live");
                    const isUpcoming = video.title.toLowerCase().includes("premiere") || 
                                      video.title.includes("Scheduled") || 
                                      video.pubDate > new Date().toISOString();

                    const card = document.createElement('div');
                    card.className = 'yt-video';
                    card.innerHTML = `
                        ${isUpcoming || isLive ? `<div class="upcoming-badge ${isLive?'live-now':''}">${isLive?'LIVE NOW':'UPCOMING'}</div>` : ''}
                        <iframe src="https://www.youtube.com/embed/${videoId}?rel=0" allowfullscreen loading="lazy"></iframe>
                        <div class="title">${video.title}</div>
                    `;
                    container.appendChild(card);
                    shown++;
                }
            } catch (e) {
                container.innerHTML = '<div style="grid-column:1/-1;color:#ff0066;">Couldn\'t load YouTube videos ðŸ˜¢</div>';
            }
        }

        // Lightbox
        document.addEventListener('DOMContentLoaded', () => {
            loadItems();
            loadYouTubeVideos();

            const overlay = document.getElementById('lightbox-overlay');
            const img = document.getElementById('lightbox-image');
            document.getElementById('store-content').addEventListener('click', e => {
                if (e.target.classList.contains('item-image')) {
                    img.src = e.target.src;
                    overlay.classList.add('show');
                }
            });
            overlay.addEventListener('click', () => {
                overlay.classList.remove('show');
                setTimeout(() => img.src = '', 300);
            });
        });
    </script>
</body>
</html>
